<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>TLib: Титульная страница</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TLib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Титульная&#160;страница</span></a></li>
      <li><a href="namespaces.html"><span>Пространства&#160;имен</span></a></li>
      <li><a href="annotated.html"><span>Классы</span></a></li>
      <li><a href="files.html"><span>Файлы</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TLib Документация</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Описание libasync.so</h2>
<p>Пакете async устанавливает следующие файлы:<br/>
 <b>/usr/lib/libasync.so</b> - библиотека async<br/>
 <b>/usr/include/async.h</b> - интерфейс библиотеки async<br/>
 <b>/usr/include/shared_EXPORTS.h</b> - необходим для кроскомпиляции с библиотекой async<br/>
 <b>/usr/include/exception_list.h</b> - вспомогательный файл для обработки исключений библиотеки async</p>
<h2>Описание особенностей моей реализации:</h2>
<p>1) За основу взята многопоточная реализация из Задания 10</p>
<p>2) Проект собирает под Windows .dll и под Linux .so файл библиотеки</p>
<p>2) Вызовы connect(), receive() и disconnect() могут осуществляться из разных потоков. При этом, между вызовами connect() и disconnect() можно вызывать receive() из разных потоков, с одним и тем же контекстом выполнения. Т.е. receive() потокобезопасен. Вызов disconnect() так же можно осуществить из любого потока, но пользователь билиотеки libasync.so должен гарантировать, что после вызова disconnect() ни один из потоков не вызовет receive().</p>
<p>3) Вызовы connect(), receive() и disconnect() могут бросать исключения. Если receive() бросает исклчение, пользователь должен гарантировать вызов disconnect(), чтобы освободить ресурсы. Если disconnect() бросает исключение, то перед возбуждеием исключения, ресурсы гарантиовано освобождются.<br/>
<br/>
 Для безопасной обработки исключений возуждаемых connect(), receive() и disconnect() рекомедуетя такой код: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;async.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;exception_list.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>roro_lib;</div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="test_c_l_parser_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>*[])</div>
<div class="line">{</div>
<div class="line">      <span class="keywordflow">try</span></div>
<div class="line">      {</div>
<div class="line">            <span class="keyword">using</span> async_t = unique_ptr&lt;void, void (*)(async::handle_t)&gt;;</div>
<div class="line"></div>
<div class="line">            std::size_t bulk = 5;</div>
<div class="line"></div>
<div class="line">            async_t h2(async::connect(bulk), async::disconnect);</div>
<div class="line">            async_t h(async::connect(bulk), async::disconnect);</div>
<div class="line"></div>
<div class="line">            async::receive(h.get(), <span class="stringliteral">&quot;1&quot;</span>, 1);</div>
<div class="line">            async::receive(h2.get(), <span class="stringliteral">&quot;1\n&quot;</span>, 2);</div>
<div class="line">            async::receive(h.get(), <span class="stringliteral">&quot;\n2\n3\n4\n5\n6\n{\na\n&quot;</span>, 15);</div>
<div class="line">            async::receive(h.get(), <span class="stringliteral">&quot;b\nc\nd\n}\n89\n&quot;</span>, 11);</div>
<div class="line"></div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (<span class="keyword">const</span> exception_ptr_list&amp; ex_list)</div>
<div class="line">      {</div>
<div class="line">            exception_ptr_list::print(ex_list);</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (<span class="keyword">const</span> exception&amp; ex)</div>
<div class="line">      {</div>
<div class="line">            <a class="code" href="namespacetlib_1_1ex.html#ab8d7fb2e4b98a7c3d829ff56e067dd49">print_nested_exception</a>(ex);</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (...)</div>
<div class="line">      {</div>
<div class="line">            cerr &lt;&lt; <span class="stringliteral">&quot;Error: unknown exception&quot;</span> &lt;&lt; endl;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Использование libasync.so</h2>
<p>После установки пакета async он готов к использованию.<br/>
 Для работы с библиотекой рекомендуется взять пример выше, и если сохранить его в файл main.cpp, то собрать его можно так: </p>
<div class="fragment"><div class="line">g++ <a class="code" href="test_c_l_parser_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>.cpp -lasync -lpthread</div>
</div><!-- fragment --><h2>Сборка libasync.so</h2>
<p>1) Для сборки под Linux см. .travis.yml</p>
<p>2) Для сборки под Windows необходим Cmake 3.14.4. Скачайте cmake-3.14.4-win32-x86.zip с <a href="https://cmake.org/download/">https://cmake.org/download/</a> и замените им Cmake в каталоге<br/>
 <b>C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake</b> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Создано системой &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
